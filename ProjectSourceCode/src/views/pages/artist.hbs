<title>Display One Artist Page</title>
{{> message }}

<div class="container mt-3">
    <div class="row">
      <div class="col-md-2">
        <!-- Artist Thumbnail on Left 1/3 of screen -->
        <img src="{{artist.thumbnail}}" class="img-fluid" alt="Artist">
      </div>
      <div class="col-md-8">
        <!-- Artist Name and Details on Right 2/3 of screen-->
        <h2 class="text-centered" id="artistInfo" data-artist-name="{{artist.name}}">{{artist.name}}</h2>
        <div class="container-fluid" id="links_container">
          <button type="follow_button" id="follow_button" class="btn btn-outline-danger" data-artist-id="{{artist.id}}">Follow Artist</button>
          <a class="btn btn-outline-danger" href="/followedArtists">Your Follow List</a>
        </div>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col">
        <!-- Artist Bio -->
          <div id="biography-container">
            <!-- Biography content will be displayed here -->   
            {{{artist.biography}}}
          </div>
      </div>
    </div>
  </div>

  {{!-- Artworks by the artist  --}}
  <div class="container mt-3 mb-3" id="artworkContainer">
    <h3>Related Artworks</h3>
    <div class="row" id="artworkRow">
      <!--artworks are appended here! :) -->
    </div>
  </div>

  <!-- Other Artists similar to artists -->
  <div class="container mt-3 mb-3" id="similarArtistsContainer">
    <h3>Other Artists Like This</h3>
      <div class="row" id="similarArtistsRow">
        <!-- Similar artist items will be appended here -->
    </div>
  </div>

<script src = "/resources/js/script.js" type="text/javascript"></script>
  <script>
    $(document).ready(function() {
      displayRelatedArtists('{{artist.name}}');
      fetchAndDisplayArtwork('{{artist.name}}');
    });
  </script>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // Event delegation for clicks on dynamically added artwork cards
    document.addEventListener('click', (event) => {
        if (event.target.matches('.artwork-card, .artwork-card *')) {
            const artworkId = event.target.closest('.artwork-card').dataset.artworkId;
            if (artworkId) {
                window.location.href = `/artwork/${artworkId}`; // Redirect to artwork page
            }
        }
    });

    // Event delegation for clicks on dynamically added artist cards
    document.addEventListener('click', (event) => {
      if (event.target.matches('.artist-card, .artist-card *')) {
          const artistId = event.target.closest('.artist-card').dataset.artistId;
          if (artistId) {
              window.location.href = `/artist/${artistId}`; // Redirect to artist page
          }
      }
    });

    document.addEventListener('click', (event) => {
    if (event.target.matches('#follow_button')) {
      // Prevent the default button action
      event.preventDefault();

      // Get the artist ID from the artist object
      const artistId = $('#follow_button').attr('data-artist-id');
      console.log("artistID-client: " + artistId);
      const artistName= $('#artistInfo').attr('data-artist-name');
      // Make an AJAX POST request to the server
      $.ajax({
        url: '/follow', // Your server endpoint that handles the POST request
        type: 'POST',
        data: { artistId: artistId , artistName: artistName}, // Data you want to send to the server
        success: function(response) {
          // Handle success (e.g., update the button text to 'Following', display a message, etc.)
          console.log('Follow successful:', response);
        },
        error: function(xhr, status, error) {
          // Handle error
          console.log('Follow failed:', error);
        }
      });
    }
  });
});

    
</script>